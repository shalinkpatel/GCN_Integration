# R script to download selected samples
# Copy code and run on a local machine to initiate download

# Check for dependencies and install if missing
packages <- c("rhdf5")
if (length(setdiff(packages, rownames(installed.packages()))) > 0) {
    print("Install required packages")
    source("https://bioconductor.org/biocLite.R")
    biocLite("rhdf5")
}
library("rhdf5")
library("tools")

destination_file = "~/data/spate116/GCN/human_matrix_download.h5"
extracted_expression_file = "~/data/spate116/GCN/E123/K562_expression_matrix.tsv"
url = "https://s3.amazonaws.com/mssm-seq-matrix/human_matrix.h5"

# Check if gene expression file was already downloaded and check integrity, if not in current directory download file form repository
if(!file.exists(destination_file)){
    print("Downloading compressed gene expression matrix.")
    download.file(url, destination_file, quiet = FALSE)
}

# Selected samples to be extracted
samp = c("GSM999534","GSM854410","GSM999528","GSM999535","GSM999527","GSM999536","GSM999537","GSM854411","GSM999531","GSM854405","GSM999532","GSM999530","GSM999529","GSM1129239","GSM854406","GSM798059","GSM1145333","GSM999533","GSM798058","GSM854409","GSM1145334","GSM798057","GSM854404","GSM854408","GSM854407","GSM1940186","GSM1505590","GSM1838574","GSM1838576","GSM1590460","GSM1641263",
"GSM1831907","GSM1831909","GSM1940185","GSM1289409","GSM1838578","GSM1940180","GSM1940188","GSM1831904","GSM1940173","GSM1940171","GSM1940181","GSM1940183","GSM1940168","GSM1940165","GSM1641262","GSM1831903","GSM1338770","GSM1831901","GSM1590462","GSM1338771","GSM1838577","GSM1838575","GSM1940182","GSM1940176","GSM1831905","GSM1940189","GSM1641264","GSM1940184","GSM1940177","GSM1831908",
"GSM1940170","GSM1940187","GSM1940175","GSM1940178","GSM1940167","GSM1831902","GSM1289404","GSM1940164","GSM1831906","GSM1940166","GSM1940169","GSM1940179","GSM1940174","GSM1289408","GSM1289405","GSM1590464","GSM2176397","GSM1838415","GSM1838405","GSM2176393","GSM1838416","GSM2176394","GSM1838417","GSM1838409","GSM1838413","GSM2176396","GSM2176399","GSM1838406","GSM1838411","GSM1838414",
"GSM2176401","GSM1838412","GSM1838408","GSM1838410","GSM1838419","GSM1838418","GSM1838407","GSM2176400","GSM2176398","GSM1505592","GSM1838573","GSM1940172","GSM2114218","GSM2114217","GSM2114216","GSM2114219","GSM2114223","GSM2114222","GSM2114220","GSM2114227","GSM2114225","GSM2114221","GSM2114229","GSM2114230","GSM2114226","GSM2114228","GSM2114224","GSM2344356","GSM2343437","GSM2343438",
"GSM2344359","GSM2343299","GSM2343294","GSM2343290","GSM2343293","GSM2343557","GSM2343556","GSM2343551","GSM2343550","GSM2343866","GSM2138849","GSM2138848","GSM2344098","GSM2344097","GSM2344096","GSM2344095","GSM2343376","GSM2343374","GSM2343372","GSM2343370","GSM2343953","GSM2343952","GSM2343951","GSM2343950","GSM2343957","GSM2343956","GSM2138697","GSM2344280","GSM2138695","GSM2072370",
"GSM2072371","GSM2138690","GSM2138691","GSM2138868","GSM2344112","GSM2344111","GSM2344070","GSM2344075","GSM2344076","GSM2343937","GSM2343931","GSM2343930","GSM2343938","GSM2343428","GSM2343234","GSM2343584","GSM2343585","GSM2343239","GSM2138809","GSM2138808","GSM2138801","GSM2138800","GSM2138803","GSM2138802","GSM2344138","GSM2344139","GSM2344134","GSM2344137","GSM2344130","GSM2344133",
"GSM2343916","GSM2343915","GSM2343914","GSM2343913","GSM2343912","GSM2343911","GSM2343910","GSM2343436","GSM2343214","GSM2343215","GSM2343439","GSM2343219","GSM2343075","GSM2343076","GSM2344406","GSM1289400","GSM2138827","GSM2138825","GSM2138824","GSM2344152","GSM2344150","GSM2343685","GSM2343683","GSM2343682","GSM2343681","GSM2343680","GSM2138685","GSM2343278","GSM2343279","GSM2343276",
"GSM2343277","GSM2343274","GSM2343275","GSM2343273","GSM2343419","GSM2343093","GSM2343094","GSM2343898","GSM2343899","GSM2343892","GSM2343893","GSM2343891","GSM2343894","GSM2344178","GSM2344179","GSM2138851","GSM2344017","GSM2344015","GSM2344014","GSM2344011","GSM2344010","GSM2344018","GSM2343511","GSM2343250","GSM2343251","GSM2343258","GSM2343259","GSM2138738","GSM2344190","GSM2344191",
"GSM2344196","GSM2344197","GSM2344194","GSM2344195","GSM2343475","GSM2343759","GSM2343751","GSM2343750","GSM2343457","GSM2343199","GSM2343198","GSM2343195","GSM2343194","GSM2343191","GSM2343190","GSM2343997","GSM2343996","GSM2343991","GSM2343990","GSM2343568","GSM2343566","GSM2343567","GSM2343565","GSM2344240","GSM2343382","GSM2343380","GSM2343385","GSM2344408","GSM2138845","GSM2138844",
"GSM2343311","GSM2138711","GSM2138710","GSM2138713","GSM2138712","GSM2138715","GSM2138714","GSM2138717","GSM2138716","GSM2343171","GSM2343172","GSM2344386","GSM2343715","GSM2343717","GSM2343716","GSM2343718","GSM2343540","GSM2343546","GSM2343547","GSM2343548","GSM2343549","GSM2343815","GSM2138665","GSM2138664","GSM2138737","GSM2138736","GSM2138735","GSM2138734","GSM2138739","GSM2343153",
"GSM2343150","GSM2343155","GSM2343154","GSM2343485","GSM2343484","GSM2343480","GSM2343482","GSM2343739","GSM2343734","GSM2343733","GSM2343378","GSM2343835","GSM2343836","GSM2343103","GSM2343104","GSM2343454","GSM2343459","GSM2138757","GSM2138756","GSM2138759","GSM2138758","GSM2343135","GSM2343137","GSM2343136","GSM2343131","GSM2343130","GSM2343132","GSM2343676","GSM2343853","GSM2343851",
"GSM2343858","GSM2343859","GSM2343857","GSM2343854","GSM2343677","GSM2343674","GSM2343675","GSM2138876","GSM2071264","GSM2071263","GSM2138777","GSM2138776","GSM2343532","GSM2343243","GSM2343242","GSM2343117","GSM2343443","GSM2343442","GSM2343449","GSM2344328","GSM2343240","GSM2343119","GSM2343671","GSM1289399","GSM2343302","GSM2343871","GSM2343872","GSM2343301","GSM2343304","GSM2343879",
"GSM2343650","GSM2343651","GSM2343652","GSM2343653","GSM2138791","GSM2138790","GSM2138797","GSM2138796","GSM2138799","GSM2138798","GSM2343468","GSM2343460","GSM2343467","GSM2344306","GSM2343797","GSM2343796","GSM2343141","GSM2138896","GSM2138897","GSM2138894","GSM2138895","GSM2138890","GSM2138891","GSM2343636","GSM2343635","GSM2343322","GSM2344329","GSM2343116","GSM2344323","GSM2344322",
"GSM2344206","GSM2344207","GSM2343408","GSM2344365","GSM2344367","GSM2344366","GSM2343400","GSM2343402","GSM2406675","GSM2343618","GSM2343619","GSM2343611","GSM2343612","GSM2343343","GSM2343341","GSM2343663","GSM2343846","GSM2343665","GSM2138869","GSM2343667","GSM2343666","GSM2343966","GSM2343967","GSM2138867","GSM2138866","GSM2344347","GSM2344346","GSM2344345","GSM2344340","GSM2344348",
"GSM2344228","GSM2344229","GSM2343282","GSM2343281","GSM2343280","GSM2343286","GSM2343285","GSM2343289","GSM2343121","GSM2138852","GSM2138853","GSM2138850","GSM2138854","GSM2138855","GSM2138858","GSM2138859","GSM2344083","GSM2344084","GSM2343945","GSM2343946","GSM2343941","GSM2343942","GSM2343768","GSM2343769","GSM2138877","GSM2138870","GSM2138871","GSM2138872","GSM2138873","GSM2344063",
"GSM2344067","GSM2344064","GSM2344068","GSM2344069","GSM2343922","GSM2343921","GSM2344314","GSM2343476","GSM2344313","GSM2343479","GSM2344418","GSM2344298","GSM2344295","GSM2344297","GSM2344296","GSM2072361","GSM2072360","GSM2072363","GSM2072362","GSM2072365","GSM2072364","GSM2072367","GSM2072366","GSM2072369","GSM2072368","GSM2138818","GSM2138819","GSM2344108","GSM2344103","GSM2344104",
"GSM2344043","GSM2343303","GSM2343300","GSM2343873","GSM2343874","GSM2343902","GSM2343903","GSM2343905","GSM2343906","GSM2343852","GSM2138789","GSM2343510","GSM2343517","GSM2343425","GSM2343593","GSM2343220","GSM2343590","GSM2343598","GSM2343686","GSM2138832","GSM2138833","GSM2138834","GSM2138835","GSM2344183","GSM2344123","GSM2344122","GSM2344121","GSM2344127","GSM2344124","GSM2344129",
"GSM2344128","GSM2343694","GSM2343695","GSM2344044","GSM2344045","GSM2344046","GSM2344409","GSM2343208","GSM2343207","GSM2343206","GSM2343205","GSM2072496","GSM2072495","GSM2138684","GSM2344140","GSM2344149","GSM2344008","GSM2344009","GSM2343586","GSM2344308","GSM2344307","GSM2344305","GSM2138747","GSM2343269","GSM2343268","GSM2343265","GSM2343264","GSM2343267","GSM2343266","GSM2343263",
"GSM2343262","GSM2343083","GSM2343084","GSM2343087","GSM2343088","GSM2343880","GSM2344167","GSM2344166","GSM2344165","GSM2344164","GSM2344163","GSM2344162","GSM2344160","GSM2343644","GSM2343740","GSM2344241","GSM2343531","GSM2343539","GSM2343538","GSM2343249","GSM2343248","GSM2344187","GSM2344188","GSM2343180","GSM2343181","GSM2343182","GSM2343183","GSM2343184","GSM2343185","GSM2343186",
"GSM2343984","GSM2343985","GSM2343986","GSM2343987","GSM2343764","GSM2343448","GSM2343760","GSM2343763","GSM2343537","GSM2344233","GSM2344232","GSM2343516","GSM2343592","GSM2343591","GSM2343597","GSM2344407","GSM2138702","GSM2138703","GSM2138706","GSM2138707","GSM2343166","GSM2343165","GSM2344394","GSM2344395","GSM2344390","GSM2344391","GSM2343704","GSM2343703","GSM2343708","GSM2343411",
"GSM2343579","GSM2343578","GSM2344255","GSM2344254","GSM2343577","GSM2343576","GSM2343571","GSM2343572","GSM2343398","GSM2343396","GSM2344413","GSM2344411","GSM2344410","GSM2344417","GSM1289401","GSM2343324","GSM2138728","GSM2138729","GSM2138722","GSM2138723","GSM2343144","GSM2343497","GSM2343494","GSM2343492","GSM2343493","GSM2343142","GSM2343143","GSM2343149","GSM2343720","GSM2343721",
"GSM2343575","GSM2343574","GSM2344277","GSM2344276","GSM2344275","GSM2344271","GSM2344270","GSM2344279","GSM2344278","GSM2343803","GSM2343802","GSM2343807","GSM2343808","GSM2344182","GSM2344385","GSM2343643","GSM2138746","GSM2138744","GSM2138745","GSM2343129","GSM2343126","GSM2343127","GSM2343124","GSM2343122","GSM2343123","GSM2343120","GSM2344355","GSM2138889","GSM2343821","GSM2343820",
"GSM2344414","GSM2138760","GSM2138761","GSM2138762","GSM2138763","GSM2138764","GSM2138765","GSM2343452","GSM2343453","GSM2343456","GSM2344337","GSM2343455","GSM2344338","GSM2344339","GSM2344364","GSM2344360","GSM2344379","GSM2343661","GSM2343668","GSM2343848","GSM2343845","GSM2343660","GSM2343847","GSM2343664","GSM2343843","GSM2343842","GSM2138826","GSM2138788","GSM2344315","GSM2344316",
"GSM2344318","GSM2344319","GSM2343788","GSM2343789","GSM2343784","GSM2343783","GSM2344262","GSM2344263","GSM2343867","GSM2343642","GSM2343645","GSM2343860","GSM2343310","GSM2343496","GSM2343145","GSM2343146","GSM2343495","GSM2343312","GSM2344151","GSM2343315","GSM2343812","GSM2343813","GSM2343314","GSM2343810","GSM2343811","GSM2344159","GSM2343814","GSM2344213","GSM2344214","GSM2344217",
"GSM2344216","GSM2344378","GSM2343417","GSM2344370","GSM2344371","GSM2138881","GSM2138880","GSM2138888","GSM2138683","GSM2138682","GSM2343339","GSM2343337","GSM2343621","GSM2343620","GSM2470065","GSM2470066","GSM2610777","GSM2610831","GSM2610778","GSM2610830","GSM2610771","GSM2610829","GSM2610789","GSM2610786","GSM2610772","GSM2610823","GSM2610843","GSM2610801","GSM2610800","GSM2610783",
"GSM2610784","GSM2610828","GSM2610850","GSM2610768","GSM2610837","GSM2610818","GSM2610841","GSM2610780","GSM2610817","GSM2610787","GSM2610824","GSM2610845","GSM2610847","GSM2610825","GSM2610839","GSM2610856","GSM2610802","GSM2610775","GSM2610834","GSM2610840","GSM2610798","GSM2610821","GSM2610848","GSM2610851","GSM2610776","GSM2610826","GSM2610842","GSM2610819","GSM2610803","GSM2610773",
"GSM2610827","GSM2610774","GSM2610790","GSM2610858","GSM2610799","GSM2610797","GSM2610849","GSM2610779","GSM2610807","GSM2610838","GSM2610836","GSM2610816","GSM2610788","GSM2610770","GSM2610782","GSM2610835","GSM2610863","GSM2610833","GSM2610811","GSM2610785","GSM2610844","GSM2610814","GSM2610860","GSM2610855","GSM2610854","GSM2610810","GSM2610861","GSM2610781","GSM2610793","GSM2610815",
"GSM2610792","GSM2610813","GSM2610806","GSM2610862","GSM2610795","GSM2610791","GSM2610809","GSM2610859","GSM2610804","GSM2610796","GSM2610820","GSM2610822","GSM2610794","GSM2610805","GSM2610857","GSM2610808","GSM2610853","GSM2610812","GSM2610852","GSM2422928","GSM2422929","GSM2422930","GSM2423010","GSM2423011","GSM2423063","GSM2423157","GSM2423158","GSM2423227","GSM2423228","GSM2423337",
"GSM2423338","GSM2423673","GSM2423761","GSM2423762","GSM2423790","GSM2423795","GSM2424179","GSM2477622","GSM2477623","GSM2477624","GSM2477625","GSM2477626","GSM2477627","GSM2477628","GSM2477629","GSM2477630","GSM2477631","GSM2477632","GSM2477633","GSM2550027","GSM2324264","GSM2492662","GSM2492663","GSM2492664","GSM2492665","GSM2492666","GSM2492668","GSM2492669","GSM2492671","GSM2492673",
"GSM2492674","GSM2492675","GSM2492676","GSM2492677","GSM2492678","GSM2492679","GSM2492681","GSM2492683","GSM2492708","GSM2492709","GSM2492710","GSM2492711","GSM2492714","GSM2492715","GSM2492716","GSM2492717","GSM2492718","GSM2492881","GSM2492882","GSM2492918","GSM2492920","GSM2492921","GSM2492922","GSM2492923","GSM2492924","GSM2492925","GSM2492926","GSM2492927","GSM2492928","GSM2492929",
"GSM2492930","GSM2492932","GSM2492952","GSM2492953","GSM2492956","GSM2492957","GSM2492959","GSM2492960","GSM2536946","GSM2536947","GSM2536948","GSM2536949","GSM2536950","GSM2536951","GSM2536952","GSM2536953","GSM2536954","GSM2536955","GSM2536956","GSM2536957","GSM2843715","GSM2843716","GSM2843717","GSM2843718","GSM2843719","GSM2843720","GSM2843721","GSM2843722","GSM2152022","GSM2152023",
"GSM2152024","GSM2152025","GSM2152026","GSM2152027","GSM2152028","GSM2152029","GSM2152030","GSM2152031","GSM2152032","GSM2175034","GSM2175035","GSM2175036","GSM2175037","GSM2175038","GSM2175039","GSM2175040","GSM2175041","GSM2175042","GSM2175043","GSM2175044","GSM2175045","GSM2175046","GSM2175047","GSM2175048","GSM2175049","GSM2175050","GSM2175051","GSM2175052","GSM2175053","GSM2175054",
"GSM2175055","GSM2175056","GSM2175057","GSM2175058","GSM2175059","GSM2175060","GSM2175061","GSM2175062","GSM2175063","GSM2175064","GSM2175065","GSM2175066","GSM2175067","GSM2175068","GSM2175069","GSM2175070","GSM2175071","GSM2175072","GSM2175073","GSM2175074","GSM2175075","GSM2175076","GSM2175077","GSM2175078","GSM2175079","GSM2175080","GSM2175081","GSM2175082","GSM2175083","GSM2175084",
"GSM2175085","GSM2175086","GSM2175087","GSM2175088","GSM2175089","GSM2175090","GSM2175091","GSM2175092","GSM2175093","GSM2175094","GSM2175095","GSM2175096","GSM2175097","GSM2175098","GSM2175099","GSM2175100","GSM2175101","GSM2396858","GSM2396859","GSM2396860","GSM2396861","GSM2483349","GSM2483350","GSM2483351","GSM2483352","GSM2483353","GSM2483354","GSM2483355","GSM2483356","GSM2483357",
"GSM2483358","GSM2483359","GSM2483360","GSM2483361","GSM2483362","GSM2483363","GSM2483364","GSM2483365","GSM2483366","GSM2483367","GSM2483368","GSM2544700","GSM2544701","GSM2544702","GSM2544703","GSM2544704","GSM2544705","GSM2544706","GSM2544707","GSM2544708","GSM2544709","GSM2544710","GSM2544711","GSM2544712","GSM2544713","GSM2544714","GSM2544715","GSM2544716","GSM2544717","GSM2544718",
"GSM2544719","GSM2544720","GSM2544721","GSM2544722","GSM2544723","GSM2544724","GSM2544725","GSM2544726","GSM2544727","GSM2544728","GSM2544729","GSM2544730","GSM2544731","GSM2544732","GSM2544733","GSM2544734","GSM2544735","GSM2544736","GSM2544737","GSM2544738","GSM2544739","GSM2544740","GSM2544741","GSM2544742","GSM2635259","GSM2635260","GSM2635261","GSM2635262","GSM2635263","GSM2635264",
"GSM2635265","GSM2635266","GSM2635267","GSM2635268","GSM2635269","GSM2635270","GSM2635271","GSM2635272","GSM2772304","GSM2772305","GSM2772306","GSM2772307","GSM2772308","GSM2772313","GSM3031441","GSM3031442","GSM3031443","GSM3031444","GSM3031445","GSM3031446","GSM3031447","GSM3031448","GSM3031449","GSM3031450","GSM3031451","GSM3031452","GSM3031453","GSM3031454","GSM3031455","GSM3031456",
"GSM3031457","GSM3031458","GSM3031459","GSM2548569","GSM2548571","GSM2548572","GSM2548573","GSM2548574","GSM2548575","GSM2548576","GSM2548577","GSM2548578","GSM2548579","GSM2548580","GSM2548581","GSM2548582","GSM2548583","GSM3057932","GSM3057933","GSM3057934","GSM3057935","GSM3057936","GSM3057937","GSM3057938","GSM3057939","GSM2256106","GSM2256107","GSM2256108","GSM2256109","GSM2256110",
"GSM2256111","GSM2256112","GSM2256113","GSM2256114","GSM2256115","GSM2256116","GSM2256117","GSM2256118","GSM2256119","GSM2256120","GSM2256121","GSM2256122","GSM2256123","GSM2256176","GSM2406677","GSM2439241","GSM2439242","GSM2439243","GSM2439244","GSM2439245","GSM2439246","GSM2439247","GSM2439248","GSM2439249","GSM2476284","GSM2610864","GSM2610865","GSM2610866","GSM2610868","GSM2610869",
"GSM2610870","GSM2610871","GSM2610872","GSM2610873","GSM2610874","GSM2610875","GSM2610876","GSM2610877","GSM2610878","GSM2610879","GSM2610880","GSM2610881","GSM2610882","GSM2610883","GSM2610884","GSM2610885","GSM2610886","GSM2610887","GSM2610888","GSM2610889","GSM2610890","GSM2610891","GSM2610893","GSM2610894","GSM2610895","GSM2610897","GSM2610898","GSM2610899","GSM2610900","GSM2610901",
"GSM2610902","GSM2610903","GSM2610905","GSM2610906","GSM2610907","GSM2610908","GSM2610909","GSM2610910","GSM2610911","GSM2610912","GSM2610913","GSM2610914","GSM2610915","GSM2610916","GSM2610917","GSM2610918","GSM2610919","GSM2610920","GSM2610921","GSM2610922","GSM2610923","GSM2610924","GSM2610925","GSM2610926","GSM2610927","GSM2610928","GSM2610929","GSM2610930","GSM2610931","GSM2610933",
"GSM2610934","GSM2610935","GSM2610936","GSM2610937","GSM2610938","GSM2610939","GSM2610940","GSM2610942","GSM2610943","GSM2610944","GSM2610945","GSM2610946","GSM2610947","GSM2610948","GSM2610949","GSM2610950","GSM2610951","GSM2610952","GSM2610955","GSM2610956","GSM2610957","GSM2610958","GSM2610959","GSM2610961","GSM2610962","GSM2610963","GSM2610964","GSM2610965","GSM2610966","GSM2610967",
"GSM2610968","GSM2610969","GSM2610970","GSM2610971","GSM2610973","GSM2610974","GSM2610975","GSM2610976","GSM2610977","GSM2610978","GSM2610979","GSM2610980","GSM2610981","GSM2610982","GSM2610983","GSM2610984","GSM2610986","GSM2610987","GSM2610988","GSM2610989","GSM2610990","GSM2610991","GSM2610992","GSM2610993","GSM2610994","GSM2610995","GSM2610996","GSM2610997","GSM2610998","GSM2610999",
"GSM2611000","GSM2611001","GSM2611002","GSM2611003","GSM2611004","GSM2611005","GSM2611006","GSM2611007","GSM2611008","GSM2611009","GSM2611010","GSM2611011","GSM2611012","GSM2611013","GSM2611014","GSM2611015","GSM2611016","GSM2611017","GSM2611018","GSM2611019","GSM2611020","GSM2611021","GSM2611022","GSM2611023","GSM2611024","GSM2611026","GSM2611027","GSM2611028","GSM2611029","GSM2611030",
"GSM2611031","GSM2611032","GSM2611033","GSM2611034","GSM2823717","GSM2823718","GSM2823719","GSM2823720","GSM2843713","GSM2843714","GSM1967866","GSM1967867","GSM1967868","GSM1967869","GSM1967870","GSM2610867","GSM2610892","GSM2610896","GSM2610904","GSM2610932","GSM2610941","GSM2610953","GSM2610954","GSM2610960","GSM2610972","GSM2610985","GSM2611025","GSM2843711","GSM2843712","GSM1967863",
"GSM1967865","GSM3019368","GSM3019369","GSM3019375","GSM3019376","GSM3019377","GSM3019378","GSM3019380","GSM2048228","GSM2048230","GSM2982997","GSM2982998","GSM2983001","GSM2983002","GSM2983003","GSM3398449","GSM3398450","GSM3398451","GSM3398452","GSM3398453","GSM3398454","GSM3449181","GSM3449182","GSM3449183","GSM3449184","GSM3449185","GSM3449187","GSM3449188","GSM3449189","GSM3449190",
"GSM3449191","GSM3449192","GSM3449193","GSM3449194","GSM3449195","GSM3449196","GSM3449197","GSM3449198","GSM3449199","GSM3449200","GSM3449201","GSM3449202","GSM3145064","GSM3145065","GSM3145066","GSM3145067","GSM3145068","GSM3145069","GSM3145070","GSM3145071","GSM3145072","GSM3145073","GSM3145074","GSM3145075","GSM3145076","GSM3145077","GSM3145078","GSM3145079","GSM3145080","GSM3145081",
"GSM3145082","GSM3145083","GSM3145084","GSM3145085","GSM3145086","GSM3145087","GSM3145088","GSM3145089","GSM3625352","GSM3625353","GSM3625354","GSM3625355","GSM3625415","GSM3625416","GSM3625417","GSM3625418","GSM3625461","GSM3625462","GSM3625463","GSM3625476","GSM3625477","GSM3625478","GSM3625479","GSM3625486","GSM3625488","GSM3625489","GSM3625493","GSM3625494","GSM3625497","GSM3625498",
"GSM3625546","GSM3625547","GSM3625554","GSM3625555","GSM3625556","GSM3625557","GSM3625558","GSM3625559","GSM3625560","GSM3625561","GSM3625562","GSM3625563","GSM3625564","GSM3625565","GSM3625566","GSM3625567","GSM3625568","GSM3625569","GSM3625573","GSM3625574","GSM3625587","GSM3625588","GSM3625589","GSM3625590","GSM3625591","GSM3625592","GSM3625595","GSM3625596","GSM3625597","GSM3625598",
"GSM3625599","GSM3625600","GSM3625601","GSM3625602","GSM3625603","GSM3625604","GSM3625605","GSM3625606","GSM3625607","GSM3625608","GSM3625609","GSM3625610","GSM3625611","GSM3625615","GSM3625616","GSM3625617","GSM3625618","GSM3625639","GSM3625640","GSM3625641","GSM3625642","GSM3625643","GSM3625644","GSM3625645","GSM3625648","GSM3625649","GSM3625650","GSM3625651","GSM3625652","GSM3625653",
"GSM3625664","GSM3625665","GSM3625710","GSM3625711","GSM3625732","GSM3625733","GSM3625734","GSM3625735","GSM3625736","GSM3625737","GSM3625738","GSM3625739","GSM3625740","GSM3625741","GSM3625742","GSM3625743","GSM3625744","GSM3625745","GSM3625746","GSM3625747","GSM3625748","GSM3625749","GSM3625750","GSM3625751","GSM3625752","GSM3625753","GSM3625766","GSM3625767","GSM3625768","GSM3625769",
"GSM3625770","GSM3625771","GSM3625772","GSM3625773","GSM3625774","GSM3629397","GSM3629398","GSM3629399","GSM3629400","GSM3629401","GSM3629464","GSM3629465","GSM3629473","GSM3629474","GSM3629475","GSM3629484","GSM3629485","GSM3629486","GSM3629487","GSM3629488","GSM3629489","GSM3629490","GSM3629491","GSM3629492","GSM3629493","GSM3629494","GSM3629495","GSM3629496","GSM3629497","GSM3629498",
"GSM3629499","GSM3629503","GSM3629504","GSM3629505","GSM3629506","GSM3629507","GSM3629508","GSM3629509","GSM3629510","GSM3629511","GSM3629512","GSM3629524","GSM3629525","GSM3629526","GSM3629527","GSM3629528","GSM3629529","GSM3629644","GSM3629645","GSM3629646","GSM3629647","GSM3629648","GSM3629649","GSM3629650","GSM3629651","GSM3417257","GSM3417258","GSM3417259","GSM3417260","GSM3417261",
"GSM3417262","GSM3417263","GSM3417264","GSM3417265","GSM3417266","GSM3417267","GSM3417268","GSM3417269","GSM3417270","GSM3417271","GSM3417272","GSM3417273","GSM3417274","GSM3417275","GSM3417276","GSM3417277","GSM3417278","GSM3417279","GSM3417280","GSM3417281","GSM3417282","GSM3417283","GSM3417284","GSM3417285","GSM3417286","GSM3417287","GSM3417288","GSM3417289","GSM3417290","GSM3417291",
"GSM3417292","GSM3417293","GSM3417294","GSM3417295","GSM3417296","GSM3417297","GSM3417298","GSM3417299","GSM3417300","GSM3417301","GSM3417302","GSM3417303","GSM3204343","GSM3204344","GSM3324727","GSM3324728","GSM3324729","GSM3324730","GSM3324731","GSM3324732","GSM3324733","GSM3324734","GSM3324735","GSM3324736","GSM3544620","GSM3544621","GSM3544622","GSM3544624","GSM3544625","GSM3544627",
"GSM3564380","GSM3564381","GSM3564660","GSM3564661","GSM3564662","GSM3564663","GSM3564664","GSM3564665","GSM3564666","GSM3564667","GSM3564669","GSM3564670","GSM3564671","GSM3625495","GSM3625496","GSM3625593","GSM3625594","GSM3625646","GSM3625647","GSM3626602","GSM3626605","GSM3629513","GSM3629514","GSM2878443","GSM2878444","GSM2878445","GSM2878446","GSM2878447","GSM2878448","GSM2878449",
"GSM2878450","GSM2878451","GSM2878452","GSM2878453","GSM2878454","GSM2878455","GSM2878456","GSM2878457","GSM2878458","GSM2878459","GSM2878460","GSM2878461","GSM2878462","GSM2878463","GSM2878464","GSM2878465","GSM2878466","GSM2878467","GSM2878468","GSM2878469","GSM3602994","GSM3602995","GSM3602996","GSM3602997","GSM3602998","GSM3602999","GSM3603000","GSM3603001","GSM3603002","GSM3603003",
"GSM3603004","GSM3603005","GSM3544054","GSM3544055","GSM3544056","GSM3568617","GSM3568618","GSM3568619","GSM3568620","GSM3568621","GSM3568622","GSM3568623","GSM3568624","GSM3568625","GSM3568626","GSM3568627","GSM3568628","GSM3568629","GSM3568630","GSM3568631","GSM3568632","GSM3568633","GSM3568634","GSM3568635","GSM3568636","GSM3568637","GSM3568638","GSM3568639","GSM3568640","GSM3938349",
"GSM3938350","GSM3938351","GSM3938352","GSM3938353","GSM3938354","GSM3938355","GSM3938356","GSM3938357","GSM3938358","GSM3938359","GSM3938360","GSM3938361","GSM3938362","GSM3938363","GSM3938364","GSM3938365","GSM3938366","GSM3938367","GSM3938368","GSM3938369","GSM3938370","GSM3938371","GSM3938372","GSM3938373","GSM3938374","GSM3938375","GSM3938376","GSM4012725","GSM3518105","GSM3518106",
"GSM3518107","GSM3518108","GSM3518109","GSM3518110","GSM3518111","GSM3518112","GSM3518113","GSM3518114","GSM3518115","GSM3518116","GSM3566429","GSM3592365","GSM3592366","GSM3592367","GSM3592368","GSM3592369","GSM3592370","GSM3669614","GSM3669615","GSM3669616","GSM3669617","GSM3669618","GSM3669619","GSM3669620","GSM3669621","GSM3669622","GSM3669623","GSM3669624","GSM3669625","GSM3669626",
"GSM3669627","GSM3669628","GSM3669629","GSM3669630","GSM3669631","GSM3669632","GSM3669633","GSM3669634","GSM3669635","GSM3669637","GSM3669638","GSM3669639","GSM3669640","GSM3669642","GSM3669643","GSM3669644","GSM3669645","GSM3669646","GSM3669647","GSM3669648","GSM3669649","GSM3669650","GSM3669651","GSM3669652","GSM3669653","GSM3669654","GSM3669655","GSM3669656","GSM3669657","GSM3669658",
"GSM3669659","GSM3669660","GSM3669661","GSM3669662","GSM3669664","GSM3669665","GSM3669666","GSM3669667","GSM3669668","GSM3669669","GSM3669670","GSM3669671","GSM3669672","GSM3669673","GSM3669674","GSM3669675","GSM3669676","GSM3669678","GSM3669679","GSM3669680","GSM3669681","GSM3669682","GSM3669683","GSM3669684","GSM3669686","GSM3669687","GSM3669689","GSM3669691","GSM3669693","GSM3669695",
"GSM3669696","GSM3669697","GSM3669698","GSM3669699","GSM3669700","GSM3669702","GSM3669703","GSM3669704","GSM3669705","GSM3669706","GSM3669707","GSM3669708","GSM3669709","GSM3669711","GSM3669712","GSM3669713","GSM3669714","GSM3669715","GSM3669717","GSM3669718","GSM3669719","GSM3669722","GSM3669723","GSM3669724","GSM3669725","GSM3669726","GSM3669727","GSM3669728","GSM3669729","GSM3669730",
"GSM3669731","GSM3669732","GSM3669733","GSM3669734","GSM3669735","GSM3669736","GSM3669737","GSM3669738","GSM3669739","GSM3669740","GSM3669741","GSM3669742","GSM3669743","GSM3669744","GSM3669745","GSM3669746","GSM3669747","GSM3669748","GSM3669749","GSM3669750","GSM3669751","GSM3669752","GSM3669753","GSM3669754","GSM3669755","GSM3669756","GSM3669757","GSM3669758","GSM3669759","GSM3669760",
"GSM3669761","GSM3669762","GSM3669763","GSM3669764","GSM3669765","GSM3669766","GSM3669767","GSM3669768","GSM3669769","GSM3669770","GSM3669771","GSM3669772","GSM3669773","GSM3669774","GSM3669775","GSM3669776","GSM3669777","GSM3669778","GSM3669779","GSM3669780","GSM3669781","GSM3669782","GSM3669783","GSM3669785","GSM3669787","GSM3669788","GSM3669789","GSM3669790","GSM3669792","GSM3669794",
"GSM3669795","GSM3669798","GSM3669799","GSM3669800","GSM3669801","GSM3669802","GSM3669803","GSM3669804","GSM3722678","GSM3722679","GSM3722680","GSM3722681","GSM3722682","GSM3722683","GSM3722684","GSM3722685","GSM3722686","GSM3722687","GSM3722688","GSM3722689","GSM3722690","GSM3722691","GSM3722692","GSM3722693","GSM3722694","GSM3722695","GSM3722696","GSM3722697","GSM3722698","GSM3722699",
"GSM3722700","GSM3722701","GSM3722702","GSM3722703","GSM3722704","GSM3722705","GSM3722706","GSM3722707","GSM3722708","GSM3722709","GSM3722710","GSM3722711","GSM3722712","GSM3722713","GSM3722714","GSM3722715","GSM3722716","GSM3722717","GSM3722718","GSM3722719","GSM3722720","GSM3722721","GSM3722722","GSM3722723","GSM3722724","GSM3722725","GSM3722726","GSM3722727","GSM3722728","GSM3722729",
"GSM3722730","GSM3722731","GSM3722732","GSM3722733","GSM3722734","GSM3722735","GSM3722736","GSM3722739","GSM3722740","GSM3722741","GSM3722742","GSM3722743","GSM3722744","GSM3349063","GSM3349064","GSM3349065","GSM3349066","GSM3349067","GSM3349068","GSM3349069","GSM3349070","GSM3349071","GSM3349072","GSM3349073","GSM3349074","GSM3349075","GSM3349076","GSM3349077","GSM3349078","GSM3349079",
"GSM3349080","GSM3349081","GSM3349082","GSM3349083","GSM3349084","GSM3349085","GSM3349086","GSM2448639","GSM2448640","GSM2448641","GSM2448642","GSM2448643","GSM2448644","GSM2448645","GSM2448646","GSM2448647","GSM2448648","GSM2448649","GSM2448650","GSM2448654","GSM2448655","GSM2448656","GSM3498210","GSM3498211","GSM3498212","GSM3498213","GSM3498214","GSM3498215","GSM3498216","GSM3498217",
"GSM4027004","GSM4027005","GSM4027006","GSM4027007","GSM4027008","GSM4027009","GSM4027010","GSM4027011","GSM4027012","GSM4027013","GSM4027014","GSM4027015","GSM4027016","GSM4027017","GSM4027018","GSM4027019","GSM4027020","GSM4027021","GSM4027022","GSM4027023","")

# Retrieve information from compressed data
samples = h5read(destination_file, "meta/Sample_geo_accession")
tissue = h5read(destination_file, "meta/Sample_source_name_ch1")
genes = h5read(destination_file, "meta/genes")

# Identify columns to be extracted
sample_locations = which(samples %in% samp)

# extract gene expression from compressed data
expression = h5read(destination_file, "data/expression", index=list(1:length(genes), sample_locations))
H5close()
rownames(expression) = genes
colnames(expression) = samples[sample_locations]

# Print file
write.table(expression, file=extracted_expression_file, sep="\t", quote=FALSE)
print(paste0("Expression file was created at ", getwd(), "/", extracted_expression_file))


